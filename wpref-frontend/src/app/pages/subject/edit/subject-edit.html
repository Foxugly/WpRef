<div class="page">
  <div class="title">Modifier un sujet</div>
  <form (ngSubmit)="save()" [formGroup]="form" class="card">
    <label>Nom</label>
    <input formControlName="name" id="name" pInputText type="text"/>
    @if (form.controls.name.touched && form.controls.name.invalid) {
      <small class="field-error">Nom requis (≥ 2 caractères)</small>
    }

    <label>Description</label>
    <p-editor [style]="{ height: '100px' }" formControlName="description" placeholder="Description…"/>
    <div class="actions">
      <p-button (onClick)="save()" id="btn_save" label="Enregistrer" severity="primary"/>
      <p-button id="btn_back" label="Annuler" routerLink="/subject/list" severity="secondary"/>
    </div>
  </form>

  <div class="card" style="margin-top: 5px;">
    <div class="header-line">
      <span class="title">Questions associées</span>
      <div class="actions">
        <p-button routerLink="/question/add" id="btn_add_question" label="Ajouter une question" size="small" severity="primary"/>
      </div>
    </div>
    @if ((questions || []).length === 0) {
      <p class="muted">Aucune question.</p>
    } @else {
      <table class="table">
        <thead>
        <tr>
          <th>Titre</th>
          <th style="width:160px;"></th>
        </tr>
        </thead>
        <tbody>
          @for (q of questions; track q.id) {
            <tr>
              <td>{{ q.title }}</td>
              <td class="row-actions">
                <a (click)="goEdit(q.id)">Éditer</a> ·
                <a (click)="goDelete(q.id)">Supprimer</a>
              </td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>
</div>
