<div class="page">
  <div class="title">Modifier un sujet</div>
  <form (ngSubmit)="save()" [formGroup]="form" class="card">
    <label>Nom</label>
    <input formControlName="name" id="name" pInputText type="text"/>
    @if (form.get('name')?.touched && form.get('name')?.invalid) {
      <small class="field-error">Nom requis (≥ 2 caractères)</small>
    }

    <label>Description</label>
    <p-editor [style]="{ height: '100px' }" formControlName="description" placeholder="Description…"></p-editor>
    <div class="actions">
      <p-button (onClick)="save()" icon="pi pi-save" id="btn_save" label="Enregistrer" severity="primary"></p-button>
      <p-button (onClick)="goBack()" id="btn_back" label="Annuler" severity="secondary"></p-button>
    </div>
  </form>

  <div class="card" style="margin-top: 5px;">
    <div class="header-line">
      <span class="title">Questions associées</span>
      <div class="actions">
        <p-button (onClick)="goQuestionNew()"
                  icon="pi pi-plus" id="btn_add_question" label="Ajouter une question" severity="primary"
                  size="small"></p-button>
      </div>
    </div>
    @if ((questions || []).length === 0) {
      <p class="muted">Aucune question.</p>
    } @else {
      <table class="table">
        <thead>
        <tr>
          <th>Titre</th>
          <th style="width:60px;">Actions</th>
        </tr>
        </thead>
        <tbody>
          @for (q of questions; track q.id) {
            <tr>
              <td>{{ q.title }}</td>
              <td class="row-actions">
                <p-button id="btn_edit_question" icon="pi pi-pencil" (click)="goQuestionEdit(q.id)" severity="info"
                          size="small"/>
                <p-button id="btn_delete_question" icon="pi pi-trash" (click)="goQuestionDelete(q.id)" severity="danger"
                          size="small"/>
              </td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>
</div>
